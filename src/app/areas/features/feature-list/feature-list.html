<navbar>
  <app-header></app-header>
</navbar>

<main>
  <section class="container">
    <h1 class="page-title">Feature Request List</h1>
  </section>

  <section class="container">
    <a class="btn btn-success pull-right"
      ui-sref="app.feature-create">
      Submit Feature
    </a>
    <form class="form-inline form-search">
      <div class="form-group search">
        <label class="sr-only" for="search">Search features</label>
        <input type="text" class="form-control" id="search" placeholder="Search features..."
          ng-model="searchFeatures">
          <i class="ion-ios-search-strong"></i>
      </div>
    </form>
    
    <column-toggle
      columns="$ctrl.tablePrefs.columns"
      change-column-visibility="$ctrl.changeColumnVisibility()"></column-toggle>

    <div class="btn-group" role="group" aria-label="...">
      <button type="button" class="btn btn-default btn-icon"
        ng-click="$ctrl.changeTableWidth('container-fluid')"
        ng-class="{'active' : $ctrl.tablePrefs.width == 'container-fluid'}">
        <i class="ion-arrow-expand"></i>
      </button>
      <button type="button" class="btn btn-default btn-icon"
        ng-click="$ctrl.changeTableWidth('container')"
        ng-class="{'active' : $ctrl.tablePrefs.width == 'container'}">
        <i class="ion-arrow-shrink"></i>
      </button>
    </div>
    
  </section>

  <section ng-class="$ctrl.tablePrefs.width">
    <table class="table table-striped table-hover">
      <thead>
        <th ng-repeat="column in $ctrl.tablePrefs.columns" ng-if="column.display" class="sortable {{ column.thAlign }}">
          <span ng-click="$ctrl.changeColumnSort(column.id, $ctrl.tablePrefs.reverse)">
            {{column.displayName}}
            <span ng-show="$ctrl.tablePrefs.type == column.id && !$ctrl.tablePrefs.reverse" class="ion-arrow-down-b"></span>
            <span ng-show="$ctrl.tablePrefs.type == column.id && $ctrl.tablePrefs.reverse" class="ion-arrow-up-b"></span>
          </span>
        </th>
      </thead>
      <tbody>
        <!-- <tr ng-repeat="feature in $ctrl.paginatedFeatures | orderBy:$ctrl.tablePrefs.type:$ctrl.tablePrefs.reverse | filter:searchFeatures"
          ui-sref="app.feature-detail({id:feature.$id})"> -->
        <tr ng-repeat="feature in $ctrl.paginatedFeatures" ui-sref="app.feature-detail({id:feature.$id})">
          <td ng-if="$ctrl.tablePrefs.columns.status.display"><span class="label label-success">{{feature.status}}</span></td>
          <td ng-if="$ctrl.tablePrefs.columns.labels.display">
            <span ng-repeat="label in feature.labels">
              <span class="label label-default mr-xs">
                <display-label data="label"></display-label>
              </span>
              <br/>
            </span>
          </td>
          <td ng-if="$ctrl.tablePrefs.columns.summary.display">{{feature.subject}}</td>
          <td ng-if="$ctrl.tablePrefs.columns.originalRequester.display" class="nowrap">{{feature.accountsMeta[0].name}}</td>
          <td ng-if="$ctrl.tablePrefs.columns.date.display" class="nowrap">{{feature.dateCreated | date }}</td>
          <td ng-if="$ctrl.tablePrefs.columns.totalValue.display" align="right">{{feature.totalValue | currency}}</td>
        </tr>
      </tbody>
    </table>
    <ul ng-if="$ctrl.pager.pages.length" class="pagination">
      <li ng-class="{disabled:$ctrl.pager.currentPage === 1}">
        <a ng-click="$ctrl.setPage(1)">First</a>
      </li>
      <li ng-class="{disabled:$ctrl.pager.currentPage === 1}">
        <a ng-click="$ctrl.setPage($ctrl.pager.currentPage - 1)">Previous</a>
      </li>
      <li ng-repeat="page in $ctrl.pager.pages" ng-class="{active:$ctrl.pager.currentPage === page}">
        <a ng-click="$ctrl.setPage(page)">{{page}}</a>
      </li>
      <li ng-class="{disabled:$ctrl.pager.currentPage === $ctrl.pager.totalPages}">
        <a ng-click="$ctrl.setPage($ctrl.pager.currentPage + 1)">Next</a>
      </li>
      <li ng-class="{disabled:$ctrl.pager.currentPage === $ctrl.pager.totalPages}">
        <a ng-click="$ctrl.setPage($ctrl.pager.totalPages)">Last</a>
      </li>
    </ul>
  </section>
</main>
